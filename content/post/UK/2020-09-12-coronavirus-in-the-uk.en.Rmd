---
title: Coronavirus in the UK
author: Emily Sheehan
date: '2020-09-12'
slug: coronavirus-in-the-uk
categories: []
tags: []
subtitle: ''
summary: ''
authors: []
lastmod: '2020-09-12T13:29:35+10:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

```{r load-libraries, include = FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE)
library(tidyverse)
library(coronavirus)
library(naniar)
library(dygraphs)
library(xts) 
library(htmlwidgets)
```

```{r load-data}
data("coronavirus")
update_dataset()
```


```{r filter-uk}
uk <- coronavirus %>%
  filter(country == "United Kingdom")#,
         #type != "recovered") 
```

```{r find-missing-data, include=FALSE}
# Analyse how many variables are missing
naniar::vis_miss(uk, warn_large_data = FALSE)
```

```{r uk-confirmed}
uk_confirmed <- uk %>% 
  filter(type == "confirmed") %>% 
  group_by(date) %>%
  summarise(cases = sum(cases))
```

```{r uk-recovered}
uk_recovered <- uk %>% 
  filter(type == "recovered")
```

```{r uk-death}
uk_death <- uk %>% 
  filter(type == "death") 
```

```{r}
#https://www.r-graph-gallery.com/318-custom-dygraphs-time-series-example.html
# create xts to use dygraph
uk_confirmed_dat <- xts(x = uk_confirmed$cases, 
                        order.by = uk_confirmed$date)

# create plot
uk_confirmed_plot <- dygraph(uk_confirmed_dat) %>%
  dyOptions(labelsUTC = TRUE, 
            # fill the graph
            fillGraph=TRUE, 
            # change shade
            fillAlpha=0.2,
            # do not include a grid
            drawGrid = FALSE, 
            colors="red") %>%
  # change the color to midnigth blue
  dyRangeSelector(fillColor = "midnightblue",
                  strokeColor = "midnightblue") %>%
  # change so it draws a line through both the date and the case number
  dyCrosshair(direction = "both") %>%
  dyHighlight(highlightCircleSize = 6, 
              highlightSeriesBackgroundAlpha = 0.2, 
              hideOnMouseOut = FALSE)  %>%
  dyRoller(rollPeriod = 1)

#saveWidget(uk_confirmed_plot, file=(here::here("content/post/UK/uk_confirmed.html")
widgetframe::frameWidget(uk_confirmed_plot)
```


```{r}
uk_confirmed %>%
  ggplot(aes(x = date,
         y = cases)) +
  geom_line()
```

```{r}
ggplot(uk,
       aes(fill = type,
           x = date,
           y = cases)) +
  geom_bar(position = "stack",
           stat = "identity")
```

