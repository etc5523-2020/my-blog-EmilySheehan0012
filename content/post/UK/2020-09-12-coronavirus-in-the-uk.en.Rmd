---
title: Coronavirus in the UK
author: Emily Sheehan
date: '2020-09-12'
slug: coronavirus-in-the-uk
categories: []
tags: []
subtitle: "Countries have had varying responses to mitigate the threat of COVID-19. For instance, the United Kingdom altered their response during the first wave and are now facing a second wave. This article will discuss how both responses have impacted the case numbers, and thus death rate." 
summary: "How the shift in public policy??? impacted the incidence of COVID-19 in the United Kingdom"
authors: []
lastmod: '2020-09-12T13:29:35+10:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

```{r load-libraries, include = FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE)
library(tidyverse)
library(coronavirus)
library(naniar)
library(dygraphs)
library(xts) 
library(htmlwidgets)

```

```{r load-data}
data("coronavirus")
update_dataset()
```


```{r filter-uk}
uk <- coronavirus %>%
  filter(country == "United Kingdom")
```

```{r find-missing-data, include=FALSE}
# Analyse how many variables are missing
naniar::vis_miss(uk, warn_large_data = FALSE)
```

```{r uk-confirmed}
uk_confirmed <- uk %>% 
  filter(type == "confirmed") %>% 
  group_by(date) %>%
  summarise(cases = sum(cases))
```

```{r uk-death}
uk_death <- uk %>% 
  filter(type == "death") %>% 
  group_by(date) %>%
  summarise(cases = sum(cases))
```

## The First Wave

The United Kingdom had its first case of COVID-19 on the 31st of January, 2020. On the 1st of March, they had 6 cases. On the 7th of March, they had 55 cases. Two weeks later, they had 1215 cases. 

In early March, the Prime Minister was reluctant to ban mass gatherings as the modeling suggested it would have little benefit. Instead, the initial response was "based on science", with Boris Johnson focusing on contact tracing and isolation of those exposed to COVID-19 (Hunter, 2020). 

The U.K. Chief Scientist suggested herd immunity would be achieved if 60% or more of the population recovered from COVID-19 (Hunter, 2020). In this sense, the UK was striving towards attaining herd immunity while protecting the elderly and immunocompromised. A leading epidemiologist likened this approach to "a satire" (Hanage, 2020), as this would mean a high number of deaths and devastation across the country. 

On March 16, the UK shifted their public policy instructing citizens to avoid mass gatherings, work from home if possible, avoid non-essential travel and isolate if they had symptoms. On March 20, all pubs, all restaurants and most schools were closed. Approximately three weeks later the number of COVID-19 cases began to peak. 

```{r}
uk_confirmed %>%
  ggplot(aes(x = date,
         y = cases)) +
  geom_line() +
  theme_bw() +
  theme(panel.border = element_blank(),
        axis.ticks = element_blank()) +
  xlab("Date") +
  ylab("Number of New COVID-19 Cases") + 
  annotate(geom="pointrange",
           x=as.Date("2020-01-31"), 
           y = 2,
           ymin = 0, 
           ymax = 1100, 
           color = "red") +
  annotate("text",  
           x = as.Date("2020-01-31"), 
           y = 1260, 
           label = "First Case",
           color= "red", 
           size = 3.5) +
  annotate(geom="pointrange",
           x=as.Date("2020-03-06"), 
           y = 6,
           ymin = 0, 
           ymax = 1500, 
           color = "blue") +
  annotate("text",  
           x = as.Date("2020-03-01"), 
           y = 1860, label = "1st March",
           color= "blue", 
           size = 3.5) +
  annotate("text",  
           x = as.Date("2020-03-01"), 
           y = 1660, 
           label = "6 cases",
           color= "blue", 
           size = 3.5) + 
    annotate(geom="pointrange",
           x=as.Date("2020-03-07"), 
           y = 55,
           ymin = 0, 
           ymax = 2500, 
           color = "red") +
  annotate("text",  
           x = as.Date("2020-03-07"),
           y = 2860, 
           label = "7th March",
           color= "blue", 
           size = 3.5) +
  annotate("text",  
           x = as.Date("2020-03-07"), 
           y = 2660, 
           label = "55 cases",
           color= "blue", 
           size = 3.5) 
  
```


## The Second Wave

```{r confirmed-plot}
#https://www.r-graph-gallery.com/318-custom-dygraphs-time-series-example.html
# create xts to use dygraph
uk_confirmed_dat <- xts(x = uk_confirmed$cases, 
                        order.by = uk_confirmed$date)

# create plot
uk_confirmed_plot <- dygraph(uk_confirmed_dat,
                             main = "Number of New COVID-19 Cases in the United Kingdom per day") %>%
  dyOptions(labelsUTC = TRUE, 
            # fill the graph
            fillGraph=TRUE, 
            # change shade
            fillAlpha=0.2,
            # do not include a grid
            drawGrid = FALSE, 
            colors="red") %>%
  # change the color to midnigth blue
  dyRangeSelector(fillColor = "midnightblue",
                  strokeColor = "midnightblue") %>%
  # change so it draws a line through both the date and the case number
  dyCrosshair(direction = "both") %>%
  dyHighlight(highlightCircleSize = 6, 
              highlightSeriesBackgroundAlpha = 0.2, 
              hideOnMouseOut = FALSE)  %>%
  dyRoller(rollPeriod = 1) %>%
  dyAxis("y", label = "Number of Cases") %>%
  dyAxis("x", label = "Date") %>%
  dySeries("V1", label = "Number of New Daily Cases") #%>%
  #dyShading(from = "2020-03-08", to = "2020-07-02") 

#saveWidget(uk_confirmed_plot, file=(here::here("content/post/UK/uk_confirmed.html")
widgetframe::frameWidget(uk_confirmed_plot)
```

```{r death-plot}
uk_death_dat <- xts(x = uk_death$cases, 
                        order.by = uk_death$date)

# create plot
uk_death_plot <- dygraph(uk_death_dat,
                             main = "Number of COVID-19 Deaths in the United Kingdom per day") %>%
  dyOptions(labelsUTC = TRUE, 
            # fill the graph
            fillGraph=TRUE, 
            # change shade
            fillAlpha=0.2,
            # do not include a grid
            drawGrid = FALSE, 
            colors="grey") %>%
  # change the color to midnight blue
  dyRangeSelector(fillColor = "midnightblue",
                  strokeColor = "midnightblue") %>%
  # change so it draws a line through both the date and the case number
  dyCrosshair(direction = "both") %>%
  dyHighlight(highlightCircleSize = 6, 
              highlightSeriesBackgroundAlpha = 0.2, 
              hideOnMouseOut = FALSE)  %>%
  dyRoller(rollPeriod = 1) %>%
  dyAxis("y", label = "Number of Deaths per Day") %>%
  dyAxis("x", label = "Date") %>%
  dySeries("V1", label = "Number of Daily Deaths") 

#saveWidget(uk_confirmed_plot, file=(here::here("content/post/UK/uk_confirmed.html")
widgetframe::frameWidget(uk_death_plot)
```




```{r}
ggplot(uk,
       aes(fill = type,
           x = date,
           y = cases)) +
  geom_bar(position = "stack",
           stat = "identity")
```

## References

Hunter, D. J. (2020). Covid-19 and the stiff upper lip—The pandemic response in the United Kingdom. The New England Journal of Medicine. Retrieved from https://www.nejm.org/doi/full/10.1056/NEJMp2005755

Hanage, W. (2020). I’m an epidemiologist. When I heard about Britain’s ‘herd immunity’coronavirus plan, I thought it was satire. The Guardian, 03–15.

